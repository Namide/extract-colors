<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>color/ColorsGroup.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-core.module_Color.html">Color</a><ul class='methods'><li data-type='method'><a href="module-core.module_Color.html#distance">distance</a></li><li data-type='method'><a href="module-core.module_Color.html#getSaturation">getSaturation</a></li><li data-type='method'><a href="module-core.module_Color.html#getWeight">getWeight</a></li></ul></li><li><a href="module-core.module_ColorGroup.html">ColorGroup</a><ul class='methods'><li data-type='method'><a href="module-core.module_ColorGroup.html#addColor">addColor</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#addGroup">addGroup</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getColors">getColors</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getList">getList</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getMaxCountColor">getMaxCountColor</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getMaxWeight">getMaxWeight</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getMaxWeightColor">getMaxWeightColor</a></li></ul></li><li><a href="module-core.module_ColorsExtractor.html">ColorsExtractor</a><ul class='methods'><li data-type='method'><a href="module-core.module_ColorsExtractor.html#extract">extract</a></li><li data-type='method'><a href="module-core.module_ColorsExtractor.html#process">process</a></li><li data-type='method'><a href="module-core.module_ColorsExtractor.html#~testFunction">testFunction</a></li><li data-type='method'><a href="module-core.module_ColorsExtractor.html#~testNumber">testNumber</a></li><li data-type='method'><a href="module-core.module_ColorsExtractor.html#~testUint">testUint</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="browser.module_Browser.html">Browser</a><ul class='methods'><li data-type='method'><a href="browser.module_Browser.html#~extractColors">extractColors</a></li><li data-type='method'><a href="browser.module_Browser.html#~extractColorsFromImage">extractColorsFromImage</a></li><li data-type='method'><a href="browser.module_Browser.html#~extractColorsFromImageData">extractColorsFromImageData</a></li><li data-type='method'><a href="browser.module_Browser.html#~extractColorsFromSrc">extractColorsFromSrc</a></li><li data-type='method'><a href="browser.module_Browser.html#~getImageData">getImageData</a></li></ul></li><li><a href="module-core.module_Color.html">Color</a><ul class='methods'><li data-type='method'><a href="module-core.module_Color.html#distance">distance</a></li><li data-type='method'><a href="module-core.module_Color.html#getSaturation">getSaturation</a></li><li data-type='method'><a href="module-core.module_Color.html#getWeight">getWeight</a></li></ul></li><li><a href="module-core.module_ColorGroup.html">ColorGroup</a><ul class='methods'><li data-type='method'><a href="module-core.module_ColorGroup.html#addColor">addColor</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#addGroup">addGroup</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getColors">getColors</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getList">getList</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getMaxCountColor">getMaxCountColor</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getMaxWeight">getMaxWeight</a></li><li data-type='method'><a href="module-core.module_ColorGroup.html#getMaxWeightColor">getMaxWeightColor</a></li></ul></li><li><a href="module-core.module_ColorsExtractor.html">ColorsExtractor</a><ul class='methods'><li data-type='method'><a href="module-core.module_ColorsExtractor.html#extract">extract</a></li><li data-type='method'><a href="module-core.module_ColorsExtractor.html#process">process</a></li><li data-type='method'><a href="module-core.module_ColorsExtractor.html#~testFunction">testFunction</a></li><li data-type='method'><a href="module-core.module_ColorsExtractor.html#~testNumber">testNumber</a></li><li data-type='method'><a href="module-core.module_ColorsExtractor.html#~testUint">testUint</a></li></ul></li><li><a href="node.module_Node.html">Node</a><ul class='methods'><li data-type='method'><a href="node.module_Node.html#~extractColors">extractColors</a></li><li data-type='method'><a href="node.module_Node.html#~extractColorsFromImageData">extractColorsFromImageData</a></li><li data-type='method'><a href="node.module_Node.html#~extractColorsFromSrc">extractColorsFromSrc</a></li><li data-type='method'><a href="node.module_Node.html#~getImageData">getImageData</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">color/ColorsGroup.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Color from './Color'

/**
 * Group colors with algorithms to optimize and merge neighbors colors.
 *
 * @module ColorGroup
 * @memberof module:core
 */

/**
 * @class
 * @classdesc Manage list of colors or groups.
 */
export default class ColorGroup {
  /**
   * Store colors or groups and count similiar groups in the image.
   */
  constructor () {
    this.count = 1
    this.children = { }
  }

  /**
   * Add a key for a color, this key is a simplification to find neighboring colors.
   * Neighboring colors has same key.
   *
   * @param {Number} key  Simplication of color
   */
  addGroup (key) {
    if (this.children[key]) {
      this.children[key].count++
    } else {
      this.children[key] = new ColorGroup()
    }

    return this.children[key]
  }

  /**
   * Add color to the group.
   *
   * @param {Number} hex  Hexadecimal color from 0x000000 to 0xFFFFFF
   * @param {Number} red  Integer red chanel from 0 to 255
   * @param {Number} green  Integer green chanel from 0 to 255
   * @param {Number} blue  Integer blue chanel from 0 to 255
   */
  addColor (hex, red, green, blue) {
    if (this.children[hex]) {
      this.children[hex].count++
    } else {
      this.children[hex] = new Color(red, green, blue, hex)
    }

    return this.children[hex]
  }

  /**
   * Get list of groups of list of colors.
   */
  getList () {
    return Object.keys(this.children)
      .map((key) => this.children[key])
  }

  /**
   * Max color weight between the children colors, depends of his saturation and his count.
   *
   * @param {Number} saturationImportance  Determine the weight of the saturation for the calcul (from 0 to 1)
   * @param {Number} count  Number of pixels in the image.
   * @returns {Number}
   */
  getMaxWeight (saturationImportance, count) {
    if (this.maxWeight === undefined) {
      const list = this.getList()
        .map((child) => (child.isColor ? child.getWeight(saturationImportance, count) : child.getMaxWeight(saturationImportance, count)))

      list.sort((a, b) => b - a)
      this.maxWeight = list[0] || 0
    }

    return this.maxWeight
  }

  /**
   * Color with the the max weight between the children colors, depends of his saturation and his count.
   *
   * @param {Number} saturationImportance  Determine the weight of the saturation for the calcul (from 0 to 1)
   * @param {Number} count  Number of pixels in the image.
   * @returns {Color}
   */
  getMaxWeightColor (saturationImportance, count) {
    const list = this.getList()
    list.sort((a, b) => {
      if (a.isColor) {
        return b.getWeight(saturationImportance, count) - a.getWeight(saturationImportance, count)
      }
      return b.getMaxWeight(saturationImportance, count) - a.getMaxWeight(saturationImportance, count)
    })

    return list[0].isColor ? list[0] : list[0].getMaxWeightColor(saturationImportance, count)
  }

  /**
   * Max count of colors for a group of colors.
   *
   * @returns {Number}
   */
  getMaxCountColor () {
    const list = this.getList()
    list.sort((a, b) => {
      if (a.isColor) {
        return b.count - a.count
      }
      return b.getMaxCountColor() - a.getMaxCountColor()
    })

    return list[0].isColor ? list[0] : list[0].getMaxCountColor()
  }

  /**
   * List of colors sorted by importance (neighboring hare calculated by distance and removed).
   * Importance is calculated with the saturation and count of neighboring colors.
   *
   * @param {Number} distance  Minimum distance between colors (from 0 to 1)
   * @param {Number} saturationImportance  Determine the weight of the saturation for the calcul (from 0 to 1)
   * @param {Number} count  Total pixels of image
   * @returns {Array&lt;Color>}
   */
  getColors (distance, saturationImportance, count) {
    const list = this.getList()
      .map((child) => {
        const { count } = child
        const color = child.getMaxCountColor()
        color.count = count
        return color
      })

    list.sort((a, b) => b.getWeight(saturationImportance, count) - a.getWeight(saturationImportance, count))

    const newList = []
    list.forEach((color) => {
      const near = newList.find((col) => col.distance(color) &lt; distance)
      if (!near) {
        newList.push(color)
      } else {
        near.count += color.count
      }
    })

    return newList
  }
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> on Sun Feb 13 2022 16:37:46 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
